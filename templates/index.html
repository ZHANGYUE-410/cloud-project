<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ—äº¬å¤§å­¦æ ¡å›­æ•°æ®åˆ†æå¹³å°</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: "Microsoft YaHei", Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #333; text-align: center; margin-bottom: 30px; font-size: 28px; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
        .stat-card { background: #4ECDC4; color: white; padding: 25px; border-radius: 8px; text-align: center; transition: transform 0.3s; }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-card h3 { font-size: 18px; margin-bottom: 10px; }
        .stat-card h2 { font-size: 32px; margin-bottom: 5px; }
        .charts { display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 25px; margin: 40px 0; }
        .chart { background: #f8f9fa; padding: 20px; border-radius: 8px; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        .chart h3 { color: #333; margin-bottom: 10px; font-size: 20px; }
        .chart p { color: #666; margin-bottom: 15px; }
        .chart img { width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .data-section { margin: 40px 0; }
        .data-section h2 { color: #333; margin-bottom: 20px; font-size: 24px; }
        .data-sample { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #4ECDC4; }
        .data-group { margin-bottom: 30px; }
        .data-group h3 { color: #4ECDC4; margin-bottom: 15px; font-size: 20px; }
        .loading { text-align: center; padding: 50px; color: #666; }
        .error { color: #dc3545; text-align: center; padding: 20px; }
        .back-home { display: block; text-align: center; margin: 20px 0; color: #4ECDC4; text-decoration: none; font-size: 16px; }
        .back-home:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <h1>åŒ—äº¬å¤§å­¦æ ¡å›­æ•°æ®åˆ†æå¹³å°</h1>

        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats">
            <div class="stat-card">
                <h3>å›¾ä¹¦æ•°æ®</h3>
                <h2>{{ stats['books_count'] }}</h2>
                <p>æ¡æœ‰æ•ˆè®°å½•</p>
            </div>
            <div class="stat-card">
                <h3>è¯¾ç¨‹æ•°æ®</h3>
                <h2>{{ stats['courses_count'] }}</h2>
                <p>æ¡æœ‰æ•ˆè®°å½•</p>
            </div>
            <div class="stat-card">
                <h3>æ–°é—»æ•°æ®</h3>
                <h2>{{ stats['news_count'] }}</h2>
                <p>æ¡æœ‰æ•ˆè®°å½•</p>
            </div>
            <div class="stat-card">
                <h3>å…¬å‘Šæ•°æ®</h3>
                <h2>{{ stats['notices_count'] }}</h2>
                <p>æ¡æœ‰æ•ˆè®°å½•</p>
            </div>
            <div class="stat-card">
                <h3>æ€»æ•°æ®é‡</h3>
                <h2>{{ stats['summary']['total_records'] }}</h2>
                <p>æ¡æ±‡æ€»è®°å½•</p>
            </div>
        </div>

        <!-- å¯è§†åŒ–å›¾è¡¨ -->
        <h2>ğŸ“Š æ•°æ®å¯è§†åŒ–åˆ†æ</h2>
        <div class="charts">
            {% for chart in charts %}
                <div class="chart">
                    <h3>{{ chart.name }}</h3>
                    <p>{{ chart.desc }}</p>
                    <!-- å®¹é”™ï¼šå›¾è¡¨å›¾ç‰‡ä¸å­˜åœ¨æ—¶æ˜¾ç¤ºå ä½ -->
                    <img src="/static/images/{{ chart.file }}" 
                         alt="{{ chart.name }}" 
                         onerror="this.src='https://via.placeholder.com/800x400?text={{ chart.name }}+å›¾è¡¨åŠ è½½å¤±è´¥'">
                </div>
            {% endfor %}
        </div>

        <!-- æ•°æ®æ ·æœ¬ -->
        <div class="data-section">
            <h2>ğŸ“‹ æ ¸å¿ƒæ•°æ®æ ·æœ¬ [å‰10æ¡]</h2>
            <div id="data-sample" class="loading">
                <p>æ­£åœ¨åŠ è½½æ•°æ®æ ·æœ¬...</p>
            </div>
        </div>

        <a href="/" class="back-home">ğŸ”„ åˆ·æ–°é¡µé¢</a>
    </div>

    <script>
        // åŠ è½½æ•°æ®æ ·æœ¬ï¼ˆé€‚é…app.pyçš„/api/samplesæ¥å£ï¼‰
        async function loadDataSamples() {
            try {
                const response = await fetch('/api/samples');
                if (!response.ok) throw new Error('æ¥å£è¯·æ±‚å¤±è´¥');
                
                const data = await response.json();
                let html = '';

                // å›¾ä¹¦æ ·æœ¬
                if (data.books_sample.length > 0) {
                    html += '<div class="data-group"><h3>ğŸ“š å›¾ä¹¦æ•°æ®æ ·æœ¬</h3>';
                    data.books_sample.forEach(book => {
                        html += `
                        <div class="data-sample">
                            <strong>${book.title || 'æœªçŸ¥æ ‡é¢˜'}</strong> - ${book.author || 'æœªçŸ¥ä½œè€…'}<br>
                            åˆ†ç±»ï¼š${book.category || 'æœªçŸ¥'} | å‡ºç‰ˆå¹´ä»½ï¼š${book.year || 'æœªçŸ¥'}
                        </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html += '<div class="error">âš ï¸ å›¾ä¹¦æ•°æ®æ ·æœ¬ä¸ºç©º</div>';
                }

                // è¯¾ç¨‹æ ·æœ¬
                if (data.courses_sample.length > 0) {
                    html += '<div class="data-group"><h3>ğŸ“– è¯¾ç¨‹æ•°æ®æ ·æœ¬</h3>';
                    data.courses_sample.forEach(course => {
                        html += `
                        <div class="data-sample">
                            <strong>${course.name || 'æœªçŸ¥è¯¾ç¨‹'}</strong> - ${course.teacher || 'æœªçŸ¥æ•™å¸ˆ'}<br>
                            é™¢ç³»ï¼š${course.department || 'æœªçŸ¥'} | å­¦åˆ†ï¼š${course.credit || '0'}
                        </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html += '<div class="error">âš ï¸ è¯¾ç¨‹æ•°æ®æ ·æœ¬ä¸ºç©º</div>';
                }

                // æ–°é—»æ ·æœ¬
                if (data.news_sample.length > 0) {
                    html += '<div class="data-group"><h3>ğŸ“° æ–°é—»æ•°æ®æ ·æœ¬</h3>';
                    data.news_sample.forEach(news => {
                        html += `
                        <div class="data-sample">
                            <strong>${news.title || 'æœªçŸ¥æ ‡é¢˜'}</strong><br>
                            åˆ†ç±»ï¼š${news.category || 'æœªçŸ¥'} | å‘å¸ƒæ—¥æœŸï¼š${news.publish_date || news.date || 'æœªçŸ¥'}
                        </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html += '<div class="error">âš ï¸ æ–°é—»æ•°æ®æ ·æœ¬ä¸ºç©º</div>';
                }

                // å…¬å‘Šæ ·æœ¬
                if (data.notices_sample.length > 0) {
                    html += '<div class="data-group"><h3>ğŸ“¢ å…¬å‘Šæ•°æ®æ ·æœ¬</h3>';
                    data.notices_sample.forEach(notice => {
                        html += `
                        <div class="data-sample">
                            <strong>${notice.title || 'æœªçŸ¥æ ‡é¢˜'}</strong><br>
                            ç±»å‹ï¼š${notice.type || 'æœªçŸ¥'} | å‘å¸ƒæ—¥æœŸï¼š${notice.publish_date || notice.date || 'æœªçŸ¥'}
                        </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html += '<div class="error">âš ï¸ å…¬å‘Šæ•°æ®æ ·æœ¬ä¸ºç©º</div>';
                }

                document.getElementById('data-sample').innerHTML = html;

            } catch (err) {
                document.getElementById('data-sample').innerHTML = `
                    <div class="error">
                        âŒ æ•°æ®æ ·æœ¬åŠ è½½å¤±è´¥ï¼š${err.message}<br>
                        è¯·æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦ç”Ÿæˆï¼Œæˆ–è”ç³»ç®¡ç†å‘˜
                    </div>
                `;
                console.error('æ•°æ®åŠ è½½å¤±è´¥:', err);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        window.onload = loadDataSamples;
    </script>
</body>
</html>